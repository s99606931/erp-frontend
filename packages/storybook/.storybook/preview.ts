/**
 * ============================================================================
 * 파일명: preview.ts
 * 패키지: @erp/storybook
 * 경로: packages/storybook/.storybook/preview.ts
 * 작성일: 2025-12-19
 * ============================================================================
 *
 * [📄 파일 설명]
 * Storybook 프리뷰 설정 파일입니다.
 * 모든 스토리에 적용될 전역 스타일, 데코레이터, 파라미터를 정의합니다.
 *
 * [🎯 주요 기능]
 * 1. 전역 CSS 스타일 (@erp/ui/globals.css) 적용
 * 2. 라이트/다크 모드 배경색 설정
 * 3. 10개 테넌트 테마 프리셋 설정
 * 4. 접근성 테스트 파라미터 설정
 *
 * [📦 사용 예시]
 * 각 스토리에서 별도 설정 없이도 이 설정이 자동 적용됩니다.
 * ============================================================================
 */

import type { Preview } from '@storybook/react';
import React from 'react';
import '../src/globals.css';
// Next.js Image 컴포넌트 Mocking 코드는 Webpack Alias로 대체됨 (.storybook/mocks/next-image.tsx)

/**
 * ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 * 10개 공공기관 테넌트 테마 목록
 * 각 테마는 기관의 CI 색상을 반영합니다.
 * ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 */
const tenantThemes = [
    { name: '기본 (Default)', value: 'default' },
    { name: '서울특별시', value: 'seoul' },
    { name: '부산광역시', value: 'busan' },
    { name: '인천광역시', value: 'incheon' },
    { name: '대구광역시', value: 'daegu' },
    { name: '광주광역시', value: 'gwangju' },
    { name: '대전광역시', value: 'daejeon' },
    { name: '울산광역시', value: 'ulsan' },
    { name: '세종특별자치시', value: 'sejong' },
    { name: '경기도', value: 'gyeonggi' },
    { name: '강원도', value: 'gangwon' },
];

/**
 * ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 * Storybook 프리뷰 설정
 * ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 */
const preview: Preview = {
    parameters: {
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // 액션 자동 탐지
        // on으로 시작하는 props (onClick, onChange 등)를 자동으로 액션으로 인식
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        actions: { argTypesRegex: '^on[A-Z].*' },

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // 컨트롤 자동 매칭
        // color로 끝나는 props에 색상 피커 표시
        // date로 끝나는 props에 날짜 피커 표시
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        controls: {
            matchers: {
                color: /(background|color)$/i,
                date: /Date$/i,
            },
        },

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // 배경색 설정
        // 라이트/다크 모드 전환 가능
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        backgrounds: {
            default: 'light',
            values: [
                {
                    name: 'light',
                    value: '#ffffff',
                },
                {
                    name: 'dark',
                    value: '#1f2937',
                },
                {
                    name: 'neutral',
                    value: '#f3f4f6',
                },
            ],
        },

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // 레이아웃 설정
        // centered: 컴포넌트를 가운데 정렬
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        layout: 'centered',

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // 접근성 테스트 설정 (WCAG 2.1 AA 기준)
        // 공공기관 웹사이트는 반드시 접근성을 준수해야 합니다.
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        a11y: {
            // 접근성 검사 규칙 설정
            config: {
                rules: [
                    {
                        // 색상 대비 4.5:1 이상 필수 (WCAG AA)
                        id: 'color-contrast',
                        enabled: true,
                    },
                    {
                        // 모든 이미지에 alt 속성 필수
                        id: 'image-alt',
                        enabled: true,
                    },
                    {
                        // 버튼에 접근 가능한 이름 필수
                        id: 'button-name',
                        enabled: true,
                    },
                    {
                        // 링크에 접근 가능한 이름 필수
                        id: 'link-name',
                        enabled: true,
                    },
                    {
                        // 폼 필드에 label 연결 필수
                        id: 'label',
                        enabled: true,
                    },
                ],
            },
        },

        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        // 문서 자동 생성 설정
        // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
        docs: {
            toc: true, // 목차 표시
        },
    },

    // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    // 전역 타입 설정
    // Storybook 툴바에서 테마와 언어를 선택할 수 있습니다.
    // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    globalTypes: {
        theme: {
            name: '테넌트 테마',
            description: '공공기관별 테마 선택',
            defaultValue: 'default',
            toolbar: {
                icon: 'paintbrush',
                items: tenantThemes,
                showName: true,
                dynamicTitle: true,
            },
        },
    },

    // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    // 태그 기반 스토리 분류
    // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    tags: ['autodocs'],
};

export default preview;
