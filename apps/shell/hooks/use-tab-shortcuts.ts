/**
 * ============================================================================
 * íŒŒì¼ëª…: use-tab-shortcuts.ts
 * íŒ¨í‚¤ì§€: @erp/shell
 * ê²½ë¡œ: apps/shell/hooks/use-tab-shortcuts.ts
 * ìž‘ì„±ì¼: 2025-12-20
 * ============================================================================
 * 
 * [ðŸ“„ íŒŒì¼ ì„¤ëª…]
 * íƒ­ ì‹œìŠ¤í…œì„ ìœ„í•œ ê¸€ë¡œë²Œ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” í›…ìž…ë‹ˆë‹¤.
 * 
 * [ðŸŽ¯ ì§€ì› ë‹¨ì¶•í‚¤]
 * - Ctrl + Tab: ë‹¤ìŒ íƒ­ìœ¼ë¡œ ì´ë™
 * - Ctrl + Shift + Tab: ì´ì „ íƒ­ìœ¼ë¡œ ì´ë™
 * - Ctrl + W: í˜„ìž¬ íƒ­ ë‹«ê¸° (ë¸Œë¼ìš°ì € ê¸°ë³¸ ë™ìž‘ ë°©ì§€)
 * ============================================================================
 */

'use client';

import { useEffect } from 'react';
import { useTabStore } from '@/stores/tab-store';

export function useTabShortcuts() {
  const { nextTab, prevTab, closeTab, activeTabId } = useTabStore();

  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      // íƒ­ ê´€ë ¨ ë‹¨ì¶•í‚¤ëŠ” ìž…ë ¥ ìš”ì†Œ(input, textarea)ì— í¬ì»¤ìŠ¤ê°€ ì—†ì„ ë•Œë§Œ ë™ìž‘í•˜ë„ë¡ ì œí•œí•  ìˆ˜ë„ ìžˆì§€ë§Œ,
      // ë¸Œë¼ìš°ì € íƒ­ ë™ìž‘ê³¼ ìœ ì‚¬í•˜ê²Œ ì „ì—­ìœ¼ë¡œ í—ˆìš©í•˜ëŠ” ê²ƒì´ UXì— ì¢‹ì„ ìˆ˜ ìžˆìŒ.
      // ë‹¨, ì½”ë“œ ì—ë””í„° ê°™ì€ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œëŠ” ì¶©ëŒ ê°€ëŠ¥ì„± ìžˆìŒ.

      // Ctrl + Tab (ë‹¤ìŒ íƒ­)
      if (e.ctrlKey && e.key === 'Tab' && !e.shiftKey) {
        e.preventDefault(); // ë¸Œë¼ìš°ì € ê¸°ë³¸ íƒ­ ì „í™˜ ë°©ì§€ ì•„ë‹˜ (ë¸Œë¼ìš°ì €ëŠ” Ctrl+Tabì„ ì›¹ì•±ì— ì „ë‹¬ ì•ˆ í•  ìˆ˜ ìžˆìŒ)
        // ë¸Œë¼ìš°ì €ì˜ Ctrl+Tabì€ ë³´í†µ ì›¹íŽ˜ì´ì§€ê°€ ê°€ë¡œì±„ê¸° ì–´ë ¤ì›€. 
        // ì „ì²´í™”ë©´ ëª¨ë“œë‚˜ PWAì—ì„œëŠ” ê°€ëŠ¥í•  ìˆ˜ ìžˆìŒ.
        // ëŒ€ì•ˆìœ¼ë¡œ Alt+Right ë“±ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìžˆì§€ë§Œ, ì¼ë‹¨ ìš”êµ¬ì‚¬í•­ëŒ€ë¡œ êµ¬í˜„ ì‹œë„.
        // *ì£¼ì˜*: ì¼ë°˜ì ì¸ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ Ctrl+Tabì€ ë¸Œë¼ìš°ì € íƒ­ ì „í™˜ì´ ìš°ì„ ìˆœìœ„ê°€ ë†’ìŒ.
        // ì‚¬ìš©ìžê°€ PWAë¡œ ì„¤ì¹˜í•˜ê±°ë‚˜ ì „ì²´í™”ë©´ì¼ ë•Œ ë™ìž‘í•  ê²ƒìž„.
        // í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ Alt+Tabì´ë‚˜ ë‹¤ë¥¸ ì¡°í•©ë„ ê³ ë ¤ ê°€ëŠ¥í•˜ì§€ë§Œ ìš”êµ¬ì‚¬í•­ì„ ë”°ë¦„.
        nextTab();
      }

      // Ctrl + Shift + Tab (ì´ì „ íƒ­)
      if (e.ctrlKey && e.key === 'Tab' && e.shiftKey) {
        e.preventDefault();
        prevTab();
      }

      // Ctrl + W (íƒ­ ë‹«ê¸°)
      // ì´ëŠ” ë¸Œë¼ìš°ì € íƒ­ ë‹«ê¸°ì™€ ì¶©ëŒí•¨. ì›¹ì•±ì—ì„œëŠ” ë³´í†µ Alt+Wë¥¼ ì“°ê±°ë‚˜ í—ˆìš©ë˜ì§€ ì•ŠìŒ.
      // í•˜ì§€ë§Œ PWA í™˜ê²½ì„ ê°€ì •í•˜ê³  êµ¬í˜„.
      if (e.ctrlKey && e.key === 'w') {
        // e.preventDefault()ë¥¼ í•´ë„ ë¸Œë¼ìš°ì € íƒ­ ë‹«ê¸°ë¥¼ ë§‰ì§€ ëª»í•˜ëŠ” ê²½ìš°ê°€ ë§ŽìŒ(Chrome ë³´ì•ˆ ì •ì±…).
        // ì „ì²´í™”ë©´ ëª¨ë“œì—ì„œëŠ” ê°€ëŠ¥í•  ìˆ˜ ìžˆìŒ.
        e.preventDefault();
        if (activeTabId) {
          closeTab(activeTabId);
        }
      }
    };

    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [nextTab, prevTab, closeTab, activeTabId]);
}
